 import os
from flask import Flask
from dotenv import load_dotenv
from azure.monitor.opentelemetry import configure_azure_monitor
import logging

# Load local .env file (only in local dev)
load_dotenv()

# Read App Insights connection string
conn_str = os.getenv("APPLICATIONINSIGHTS_CONNECTION_STRING")

# Configure Azure Monitor with OpenTelemetry
if conn_str:
    configure_azure_monitor(connection_string=conn_str)

app = Flask(__name__)

# Example logging
logger = logging.getLogger(__name__)
logger.setLevel(logging.INFO)

@app.route("/")
def home():
    logger.info("Home route called ðŸš€")
    return "Hello from Flask with Azure App Insights!"

if __name__ == "__main__":
    app.run(debug=True)
